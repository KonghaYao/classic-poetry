---
import Layout from "../../layouts/Base.astro";
import {
    PageInfo,
    ShowSinglePoetry,
} from "../../components/Poetry/ShowSinglePoetry";
import { ModelControl } from "../../components/Poetry/SideBar/ModelControl";
import { getClient } from "../../meilisearch/getClient";
const { id } = Astro.params;
import mongoose from 'mongoose'
const data = await mongoose
        .connect(
            "mongodb+srv://reader:JqdKie3Zz7bKAxPz@cluster1.xavvdnu.mongodb.net/poetry?retryWrites=true&w=majority"
        )
        .then(async (db) => {
            const data = await db.models.Poetry.findOne({id}).lean()
            mongoose.disconnect();
            return data as PageInfo
        });
---

<Layout title={data?.title + " 中华诗词大典"}>
    <ShowSinglePoetry poetry={data} client:load />
    <ModelControl client:only />
</Layout>
