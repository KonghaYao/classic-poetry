---
import Layout from "../../layouts/Base.astro";
import {
    PageInfo,
    ShowSinglePoetry,
} from "../../components/Poetry/ShowSinglePoetry";
import { ModelControl } from "../../components/Poetry/SideBar/ModelControl";
import { getClient } from "../../meilisearch/getClient";
import {connectToDatabase} from '../../backend/mongo'
const { id } = Astro.params;
const data = await connectToDatabase()
        .then(async (db) => {
            const data = await db.models.Poetry.findOne({id}).lean()
            return data as PageInfo
        });
---

<Layout title={data?.title + " 中华诗词大典"}>
    <ShowSinglePoetry poetry={data} client:load />
    <ModelControl client:only />
</Layout>
